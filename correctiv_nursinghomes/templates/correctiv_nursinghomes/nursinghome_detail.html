{% extends "correctiv_nursinghomes/base.html" %}

{% load i18n %}
{% load number_utils %}
{% load humanize %}
{% load sekizai_tags %}
{% load leaflet_tags %}

{% block title %}{{ title }}{% endblock %}

{% block additional_meta %}
  <meta name="description" content="{{ description }}">
{% endblock %}

{% block top_search %}

  {% addtoblock "css" %}
    {% leaflet_css %}
  {% endaddtoblock %}

  {% addtoblock "js" %}
    {% leaflet_js %}
  {% endaddtoblock %}

  {% addtoblock "js" %}
    <script type="text/javascript">
      function map_init_basic (map, options) {
        map.scrollWheelZoom.disable();
        var home = JSON.parse('{{ object.geo.geojson|safe }}');
        var latLng = home.coordinates.reverse();
        L.marker(latLng).addTo(map);
        map.zoomControl.setPosition('topright');
        map.setView(latLng, 12);
      }
    </script>
  {% endaddtoblock %}

  <header class="custom-leaflet-map">

    <div class="custom-leaflet-map__container">
      <header class="custom-leaflet-map__header">
        <a href="{% url 'nursinghomes:nursinghomes-index' %}">
          <h1 class="custom-leaflet-map__app-title">
            {% trans "Nursing Home Guide" %}
          </h1>
        </a>
        <h2 class="custom-leaflet-map__title">
          {{ object.name }}
        </h2>
        <p class="custom-leaflet-map__subtitle">
          {{ object.provider_type }}
        </p>
      </header>
    </div>

    {% leaflet_map "yourmap" callback="window.map_init_basic" %}

  </header>


{% endblock %}

{% block content %}

  <div class="page__row">
    <div class="page__section">
      {% include "correctiv_nursinghomes/_nursinghome_intro.html" with object=object %}
    </div>

    <div class="page__sidebar">
      <p>
        {{ object.address }}<br/>
        {{ object.postcode }} {{ object.location }}
      </p>
      {% if object.data.Telefon %}
        <p>
          {% trans "Phone no.:" %} {{ object.data.Telefon }}
        </p>
      {% endif %}
      {% if object.web %}
        <p>
          <a href="{{ object.web }}">
            {% trans "Website" %}
          </a>
        </p>
      {% endif %}
    </div>
  </div>

  <div class="page__row">
    <div class="page__section">

      <header class="page__section-header ">
        <h3 class="page__section-headline">
          {% trans "From the transparency report" %}
        </h3>
      </header>

      {% include "correctiv_nursinghomes/_red_flags.html" %}
      {% include "correctiv_nursinghomes/_disclaimer.html" %}

    </div>

    <div class="page__sidebar">

      <header class="page__section-header ">
        <h3 class="page__section-headline">
          {% trans "Preisvergleich" %}
        </h3>
      </header>

      {% include "correctiv_nursinghomes/_price_comparison.html" %}

      <div class="well">
        <p>{% trans "We’ve compared ten nursing homes in your area. Important tip: If you’re looking for a good home, do not only compare prices." %}</p>
      </div>

    </div>
  </div>

  <div class="page__row">
    <div class="page__section">

      <header class="page__section-header ">
        <h3 class="page__section-headline">
          {% trans "How you can get more information" %}
        </h3>
      </header>

      {% include "correctiv_nursinghomes/_more_info.html" %}

    </div>
    <div class="page__sidebar">
    </div>
  </div>

{% endblock %}
